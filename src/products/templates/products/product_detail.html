{% extends 'base.html' %}
{% load static %}

<script>
{% block jquery %}
    function setPrice(){
        var price = $(".variation_select option:selected").attr("data-price")
        var sale_price = $(".variation_select option:selected").attr("data-sale-price")
        if (sale_price != "" && sale_price != "None" && sale_price != null ) {
            $("#price").html("<h3>" + sale_price + " <small class='og-price'>" + price  + "</small></h3>");
        } else {
            $("#price").html(price);
        }
}
    setPrice()
    $(".variation_select").change(function(){
        setPrice()
    })
{% endblock %}
</script>

{% block content %}
<div class="container">
<div class="row">
    <div class="col-sm-8">
        <h2> {{ object.title }}</h2>
        {% if object.productimage_set.count > 0 %}
        {% for img in object.productimage_set.all %}
            <img class="img-responsive" src="{{ img.image.url }}">
        {% endfor %}

        {% endif %}
        <p class="lead">{{ object.description }}</p>
    </div>
<!--     PRODUCT SIDE BAR -->
    <div class="col-sm-4">
        {% if object.variation_set.count > 1 %}
            <h3 id='price'>${{ object.variation_set.first.price }}</h3>
            <select name='item' class='form-control form-control-lg variation_select'>
                {% for vari_obj in object.variation_set.all %}
                    <option  data-sale-price="{{ vari_obj.sale_price }}" data-price="{{ vari_obj.price }}" value="{{ vari_obj.id }}">{{ vari_obj }}</option>
                {% endfor %}
            </select>
        {% else %}
            <input type="hidden" name='item' value='{{ object.variation_set.first.id }}' />
                <h3 id='price'>
                {% if object.variation_set.first.sale_price %}
                    {{ object.variation_set.first.sale_price  }}
                    <small class='og-price'>{{ object.variation_set.first.price }}</small>
                {% else %}
                    {{ object.variation_set.first.price }}
                {% endif %}
                </h3>
        {% endif %}
        <a href="#">Add to Cart</a>
    </div>
</div>
</div>
<hr />
<div class="container">
<div class="row">
    <h3>Related Products</h3>
</div>
    {% include 'products/related_products.html' with related=related %}
</div>
</div>
{% endblock %}
